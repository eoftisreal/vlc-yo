diff --git a/upnp/src/api/upnpapi.c b/upnp/src/api/upnpapi.c
index 3ad4658..b0ee7db 100644
--- a/upnp/src/api/upnpapi.c
+++ b/upnp/src/api/upnpapi.c
@@ -387,13 +387,13 @@ static int UpnpInitPreamble(void)
 		return retVal;
 	}
 
+#ifdef INTERNAL_WEB_SERVER
 #ifdef INCLUDE_DEVICE_APIS
 	#if EXCLUDE_SOAP == 0
 	SetSoapCallback(soap_device_callback);
 	#endif
 #endif /* INCLUDE_DEVICE_APIS */
 
-#ifdef INTERNAL_WEB_SERVER
 	#if EXCLUDE_GENA == 0
 	SetGenaCallback(genaCallback);
 	#endif
