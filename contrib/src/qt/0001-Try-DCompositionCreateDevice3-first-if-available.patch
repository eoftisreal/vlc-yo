diff --git a/src/gui/rhi/qrhid3dhelpers.cpp b/src/gui/rhi/qrhid3dhelpers.cpp
index 216c358cbe..79efb386eb 100644
--- a/src/gui/rhi/qrhid3dhelpers.cpp
+++ b/src/gui/rhi/qrhid3dhelpers.cpp
@@ -110,7 +110,18 @@ IDCompositionDevice *createDirectCompositionDevice()
         _In_ REFIID iid,
         _Outptr_ void **dcompositionDevice);
     DCompositionCreateDeviceFuncPtr func = reinterpret_cast<DCompositionCreateDeviceFuncPtr>(
-        dcomplib.resolve("DCompositionCreateDevice"));
+        dcomplib.resolve("DCompositionCreateDevice3"));
+
+    if (!func) {
+        qDebug("Could not resolve DCompositionCreateDevice3, dcomp.dll missing or old. Trying DCompositionCreateDevice2...");
+        func = reinterpret_cast<DCompositionCreateDeviceFuncPtr>(dcomplib.resolve("DCompositionCreateDevice2"));
+    }
+
+    if (!func) {
+        qDebug("Could not resolve DCompositionCreateDevice2, dcomp.dll missing or old. Trying DCompositionCreateDevice...");
+        func = reinterpret_cast<DCompositionCreateDeviceFuncPtr>(dcomplib.resolve("DCompositionCreateDevice"));
+    }
+
     if (!func) {
         qWarning("Unable to resolve DCompositionCreateDevice, perhaps dcomp.dll is missing?");
         return nullptr;
