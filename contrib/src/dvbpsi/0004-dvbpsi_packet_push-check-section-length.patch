diff --git a/src/dvbpsi.c b/src/dvbpsi.c
index 6b5641a..89444c5 100644
--- a/src/dvbpsi.c
+++ b/src/dvbpsi.c
@@ -377,12 +377,14 @@ bool dvbpsi_packet_push(dvbpsi_t *p_dvbpsi, uint8_t* p_data)
 
             if (!p_decoder->b_complete_header)
             {
-                /* Header is complete */
-                p_decoder->b_complete_header = true;
                 /* Compute p_section->i_length and update p_decoder->i_need */
-                p_decoder->i_need = p_section->i_length
-                                  = ((uint16_t)(p_section->p_data[1] & 0xf)) << 8
+                p_section->i_length = ((uint16_t)(p_section->p_data[1] & 0xf)) << 8
                                        | p_section->p_data[2];
+                if(p_section->i_length > 4093)
+                    return false;
+                p_decoder->i_need = p_section->i_length;
+                /* Header is complete */
+                p_decoder->b_complete_header = true;
                 /* Check that the section isn't too long */
                 if (p_decoder->i_need > p_decoder->i_section_max_size - 3)
                 {
