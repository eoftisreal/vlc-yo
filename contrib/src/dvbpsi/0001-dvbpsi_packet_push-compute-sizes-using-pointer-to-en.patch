diff --git a/src/dvbpsi.c b/src/dvbpsi.c
index cbb7511..a11d70a 100644
--- a/src/dvbpsi.c
+++ b/src/dvbpsi.c
@@ -263,6 +263,7 @@ bool dvbpsi_packet_push(dvbpsi_t *p_dvbpsi, uint8_t* p_data)
                                              section is handled */
     int i_available;                      /* Byte count available in the
                                              packet */
+    const uint8_t *p_data_end = &p_data[188]; /* end of packet */
 
     dvbpsi_decoder_t *p_decoder = p_dvbpsi->p_decoder;
     assert(p_decoder);
@@ -355,7 +356,7 @@ bool dvbpsi_packet_push(dvbpsi_t *p_dvbpsi, uint8_t* p_data)
     }
 
     /* Remaining bytes in the payload */
-    i_available = 188 + p_data - p_payload_pos;
+    i_available = p_data_end - p_payload_pos;
 
     while (i_available > 0)
     {
@@ -395,7 +396,7 @@ bool dvbpsi_packet_push(dvbpsi_t *p_dvbpsi, uint8_t* p_data)
                         p_new_pos = NULL;
                         p_decoder->i_need = 3;
                         p_decoder->b_complete_header = false;
-                        i_available = 188 + p_data - p_payload_pos;
+                        i_available = p_data_end - p_payload_pos;
                     }
                     else
                     {
@@ -480,7 +481,7 @@ bool dvbpsi_packet_push(dvbpsi_t *p_dvbpsi, uint8_t* p_data)
                     p_new_pos = NULL;
                     p_decoder->i_need = 3;
                     p_decoder->b_complete_header = false;
-                    i_available = 188 + p_data - p_payload_pos;
+                    i_available = p_data_end - p_payload_pos;
                 }
                 else
                 {
